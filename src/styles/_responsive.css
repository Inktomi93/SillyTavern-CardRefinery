/**
 * Responsive & Accessibility Overrides
 *
 * Mobile-first means base styles are mobile.
 * These add desktop enhancements and accessibility improvements.
 */

/* ═══════════════════════════════════════════════════════════════════════════════
   TOUCH-FRIENDLY TARGETS ON MOBILE
   ═══════════════════════════════════════════════════════════════════════════════ */

@media (--mobile) {
    /* Buttons: 44px minimum tap target */
    .cr-popup .menu_button {
        min-height: 44px;
        padding: var(--cr-space-3);
    }

    /* Tabs: 44px minimum tap target */
    .cr-tab {
        min-height: 44px;
    }

    /* List items: larger touch area */
    .cr-list-item {
        padding: var(--cr-space-4);
    }

    /* Always show action buttons on mobile (no hover) */
    .cr-list-item__actions {
        opacity: 1;
    }

    /* Form inputs: 44px min height, 16px font to prevent iOS zoom */
    .cr-popup input[type='text'],
    .cr-popup input[type='number'],
    .cr-popup input[type='search'],
    .cr-popup select {
        min-height: 44px;
        font-size: 16px; /* Prevents iOS zoom on focus */
    }

    /* Selects: larger touch target */
    .cr-select {
        min-height: 44px;
        padding: var(--cr-space-2) var(--cr-space-3);
        font-size: var(--cr-text-sm);
    }

    /* Checkboxes: larger tap area */
    .cr-checkbox {
        min-height: 44px;
        padding: var(--cr-space-2) 0;
    }

    .cr-checkbox input[type='checkbox'] {
        width: 20px;
        height: 20px;
    }

    /* Search clear button: larger tap target */
    .cr-search__clear {
        min-width: 44px;
        min-height: 44px;
        right: 0;
    }

    /* Drawer tabs: full-width tap targets */
    .cr-drawer__tab {
        min-height: 48px;
    }

    /* Preset list actions: always visible on touch */
    .cr-preset-list__actions {
        opacity: 1;
    }
}

/* ═══════════════════════════════════════════════════════════════════════════════
   REDUCED MOTION FOR ACCESSIBILITY
   ═══════════════════════════════════════════════════════════════════════════════ */

@media (--reduced-motion) {
    .cr-popup *,
    .cr-popup *::before,
    .cr-popup *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
}

/* ═══════════════════════════════════════════════════════════════════════════════
   HIGH CONTRAST MODE
   ═══════════════════════════════════════════════════════════════════════════════ */

@media (--high-contrast) {
    .cr-popup {
        --cr-border: var(--cr-text);
        --cr-border-muted: var(--cr-text-muted);
    }
}

/* ═══════════════════════════════════════════════════════════════════════════════
   KEYBOARD FOCUS INDICATORS
   Using :focus-visible to show focus only during keyboard navigation
   ═══════════════════════════════════════════════════════════════════════════════ */

:is(.cr-popup, .cr-drawer) {
    /* Remove default focus outline for mouse users */
    & button:focus:not(:focus-visible),
    & input:focus:not(:focus-visible),
    & select:focus:not(:focus-visible),
    & textarea:focus:not(:focus-visible),
    & a:focus:not(:focus-visible),
    & [tabindex]:focus:not(:focus-visible) {
        outline: none;
    }

    /* Visible focus ring for keyboard navigation */
    & button:focus-visible,
    & input:focus-visible,
    & select:focus-visible,
    & textarea:focus-visible,
    & a:focus-visible,
    & [tabindex]:focus-visible {
        outline: 2px solid var(--cr-accent);
        outline-offset: 2px;
    }

    /* Special handling for inputs that already have border focus */
    & input:focus-visible,
    & select:focus-visible,
    & textarea:focus-visible {
        outline-offset: 0;
        box-shadow: 0 0 0 2px var(--cr-accent-muted);
    }
}
